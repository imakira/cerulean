{"version":3,"sources":["app/router.cljc"],"mappings":"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","names":["app.router/*router*","uix.core.create_context","props__11048__auto__","props47651","uix.core/glue-args","vec__47652","map__47655","cljs.core.nth","cljs.core/--destructure-map","cljs.core.get","___11047__auto__","cljs.core.dissoc","f__11049__auto__","js/goog.DEBUG","temp__5823__auto__","app.router/router","f__10960__auto__","*current-component*-orig-val__47676","uix.core/*current-component*","*current-component*-temp-val__47677","cljs.core/map?","js/Error","uix.core/set-display-name","js/window","js/window.uix","js/window.uix.dev","sig__10969__auto__","js/window.uix.dev.signature!","js/window.uix.dev.register!","routes","initial-route","children","vec__47659","vec__47662","map__47665","map__47666","reitit-router","uix.hooks.alpha/use-memo","uix.hooks.alpha/use-clj-deps","args","reitit.core.router","route","set-route!","uix.core/use-state","or__5025__auto__","js/location.pathname","routing-state","set-routing-state!","old-routers","uix.core.use_ref","component","routing-data","reitit.core/match-by-path","uix.hooks.alpha.use_effect","history-listener","_","js/addEventListener","js/removeEventListener","cljs.core/reset!","cljs.core/deref","reitit.frontend.controllers/apply-controllers","cljs.core.update_in","data","cljs.core.merge","uix.compiler.alpha/component-element","uix.compiler.aot/>el","uix.compiler.aot/fragment","uix.compiler.attributes/interpret-attrs","props47680","vec__47681","map__47684","app.router/router-outlet","*current-component*-orig-val__47686","*current-component*-temp-val__47687","hook","map__47685","router-data","uix.core/use-context","uix.compiler.attributes/interpret-props","cljs.core.merge_with","cljs.core/into","app.router/navigate-to!","href","cljs.core/re-matches","js/history.pushState","js/undefined","js/dispatchEvent","js/PopStateEvent","props47689","vec__47690","map__47693","app.router/link","*current-component*-orig-val__47694","*current-component*-temp-val__47695","style","class","onclick","e","uix.compiler.attributes.class_names","uix.compiler.attributes/convert-props","uix.compiler.attributes/keyword->string"],"sourcesContent":["(ns app.router\n  (:require\n   [uix.core :as uix :refer\n    [defui use-state use-ref use-effect use-memo $]]\n   [reitit.core :as r]\n   [app.utils :as utils :refer [use-context]]\n   #?@(:cljs [[reitit.frontend.easy :as rfe]\n              [reitit.frontend.controllers :as rfc]])))\n\n\n(utils/defcontext *router* nil)\n\n(defui router [{:keys [routes initial-route children]}]\n  (let [reitit-router (use-memo (fn [& args]\n                                  (r/router routes))\n                                [routes])\n\n        [route set-route!] (use-state #?(:clj (or initial-route \"/index.html\")\n                                         :cljs (or initial-route js/location.pathname)))\n        [routing-state set-routing-state!] (use-state {})\n        old-routers (use-ref nil)\n\n        {{:keys [component ]} :data :as routing-data}\n        (use-memo (fn []\n                    (r/match-by-path reitit-router route))\n                  [reitit-router route])]\n    (use-effect\n     (fn []\n       #?(:cljs (let [history-listener (fn [_]\n                                         (set-route! js/location.pathname))]\n                  (js/addEventListener \"popstate\"\n                                       history-listener)\n                  (fn []\n                    (js/removeEventListener \"popstate\"\n                                            history-listener)))))\n     [])\n\n    (use-effect (fn []\n                  #?(:cljs\n                     (reset! old-routers\n                             (rfc/apply-controllers\n                              @old-routers\n                              (update-in routing-data [:data]\n                                         (fn [data]\n                                           (merge data {:routing-state routing-state\n                                                        :set-routing-state! set-routing-state!})))))))\n                [routing-data routing-state ])\n\n    (utils/context-binding\n     [*router* {:route route\n                :set-route! set-route!\n                :reitit-router reitit-router\n                :routing-data routing-data\n                :component component\n                :routing-state routing-state\n                :set-routing-state! set-routing-state!}]\n     ($ :<>\n        children))))\n\n\n(defui router-outlet [{:keys [hook]}]\n  (let [{:keys [component routing-data] :as router-data} (utils/use-context *router*)]\n    (when hook\n      (hook))\n    ($ component (merge-with into\n                             (-> routing-data :data :extra-data)\n                             routing-data))))\n\n(defn navigate-to! [href]\n  #?(:clj (throw (UnsupportedOperationException. \"Operation navigate-to! isn't supported in CLJ.\"))\n     :cljs (do\n             (if (re-matches #\"^https?://.*$\" href)\n               (set! (.. js/window -location -href) \n                     href)\n               (do (js/history.pushState js/undefined js/undefined href)\n                   (js/dispatchEvent (js/PopStateEvent. \"popstate\", js/undefined)))))))\n\n(defui link [{:keys [href children style class]}]\n  (let [onclick (fn [e]\n                  #?(:clj :default\n                     :cljs\n                     (do\n                       (.preventDefault e)\n                       (navigate-to! href))))]\n    ($ :a {:on-click onclick :style style :href href :class class}\n       children)))\n"]}